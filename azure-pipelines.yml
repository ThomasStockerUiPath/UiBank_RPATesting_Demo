trigger:
- master

pool:
# A windows agent is required to execute the plugin tasks
 vmImage: windows-2022

steps:
# Install Platform step will install the CLI which is self-contained in this task.

# If this task is not used, the CLI will be downloaded from an external nuget feed
- task: UiPathInstallPlatform@2
- task: UiPathTest@2
  inputs:
    testTarget: 'TestProject'
    orchestratorConnection: 'DemoServiceConnection'
    testProjectPath: 'Project'
    folderName: 'Modern Folder'
    testReportDestination: 'Output'

- task: UiPathPack@2
  inputs:
    versionType: 'AutoVersion'
    projectJsonPath: 'Project'
    outputType: 'Process'
    orchestratorConnection: 'DemoServiceConnection'
    outputPath: '$(Build.ArtifactStagingDirectory)\Output'
    runWorkflowAnalysis: true

- task: UiPathDeploy@2
  inputs:
    orchestratorConnection: 'DemoServiceConnection'
    packagesPath: '''$(Build.ArtifactStagingDirectory)\Output'''
    folderName: 'Modern Folder'
    entryPoints: 'Main.xaml'

- task: PublishPipelineArtifact@1
  inputs:
    targetPath: '$(Build.ArtifactStagingDirectory)\Output'
    artifact: 'UiBankProcess'
    publishLocation: 'pipeline'




